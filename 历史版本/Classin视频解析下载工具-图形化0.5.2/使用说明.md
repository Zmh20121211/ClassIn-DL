# ClassIn视频下载工具使用说明（图形化0.5.2版本）

## 一、工具概述

本工具用于下载ClassIn平台的视频课程，图形化版本提供直观的操作界面，适合大多数用户使用。

## 二、准备工作

### 1. 安装HTTP Debugger Pro

1. 打开工具包根目录中的`HTTP Debugger Pro安装程序.msi`
2. 点击`Next`
3. 选择`I accept the terms in the License Agreement`
4. 点击`Install`
5. 等待安装完成，关闭英文窗口
6. 双击根目录中的`激活.exe`，点击`Activate`，点击`确定`，然后点击`Exit`
7. 将根目录中的`HTTPDebuggerUI_ZH.exe`放置到HTTP Debugger Pro的安装根目录，替换桌面快捷方式

### 2. 配置HTTP Debugger Pro

1. 打开HTTP Debugger Pro
2. 点击顶部菜单栏的`文件` -> `设置`
3. 在`捕获`选项卡中，确保`捕获所有HTTP/HTTPS流量`被勾选
4. 点击`确定`保存设置

## 三、使用步骤

### 1. 启动工具

1. 打开当前文件夹（`Classin视频解析下载工具-图形化0.5.2`）
2. 找到并运行`Classin视频解析下载工具.exe`（如果没有可执行文件，需要使用Visual Studio编译项目）

### 2. 捕获视频请求头

1. 打开ClassIn客户端，进入要下载的课程页面
2. 播放视频，确保视频正常加载
3. 切换到HTTP Debugger Pro，点击顶部的`开始捕获`按钮
4. 在HTTP Debugger Pro中，找到包含`getLessonRecordInfo`的请求
5. 右键点击该请求，选择`复制` -> `复制完整请求`

### 3. 解析视频链接

1. 切换回ClassIn视频下载工具
2. 点击`复制命令`按钮，工具会自动将`getLessonRecordInfo`复制到剪贴板（如果已经在HTTP Debugger Pro中复制了请求头，此步骤可跳过）
3. 点击`解析`按钮，工具会自动从剪贴板中解析视频链接和名称
4. 解析成功后，视频信息会显示在列表中

### 4. 开始下载

1. （可选）点击`更改路径`按钮，选择视频保存位置
2. （可选）调整`最大并发下载数`和`最大下载线程数`
3. 点击`开始下载`按钮，开始下载视频
4. 下载过程中可以查看每个视频的下载进度、速度和剩余时间

### 5. 查看下载结果

1. 下载完成后，视频会保存在指定的下载目录中
2. 可以点击`打开文件夹`按钮直接打开下载目录

## 四、版本特有功能

### 图形化0.5.2版本新增功能

1. **优化了界面布局**：更合理的控件排列，提升用户体验
2. **增加了下载进度统计**：显示整体下载进度和已下载大小
3. **修复了已知bug**：解决了之前版本的一些问题

## 五、常见问题解决

### 1. 解析失败

- 确保已经正确复制了包含`getLessonRecordInfo`的请求头
- 确保HTTP Debugger Pro捕获到了完整的请求
- 尝试重新播放视频并重新捕获请求
- 检查是否使用了最新版本的工具

### 2. 下载失败

- 检查网络连接是否正常
- 尝试调整最大并发下载数和最大下载线程数
- 检查视频链接是否有效

### 3. 工具无法启动

- 确保已安装.NET Framework 4.7.2或更高版本
- 确保Visual Studio已安装WPF开发组件（如果需要编译项目）
- 尝试以管理员身份运行

## 六、注意事项

1. 本工具仅用于个人学习和备份，请勿用于商业用途
2. 请遵守ClassIn平台的使用协议
3. 下载过程中请保持网络连接稳定
4. 建议不要同时下载过多视频，以免影响下载速度
5. 定期清理下载目录，释放磁盘空间

## 七、技术支持

如有问题或建议，请联系工具开发者。
