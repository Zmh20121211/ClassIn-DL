# ClassIn视频下载工具使用说明（非图形化0.3.0版本）

## 一、工具概述

本工具用于下载ClassIn平台的视频课程，非图形化版本使用命令行操作，适合高级用户使用，具有更高的下载效率。

## 二、准备工作

### 1. 安装HTTP Debugger Pro

1. 打开工具包根目录中的`HTTP Debugger Pro安装程序.msi`
2. 点击`Next`
3. 选择`I accept the terms in the License Agreement`
4. 点击`Install`
5. 等待安装完成，关闭英文窗口
6. 双击根目录中的`激活.exe`，点击`Activate`，点击`确定`，然后点击`Exit`
7. 将根目录中的`HTTPDebuggerUI_ZH.exe`放置到HTTP Debugger Pro的安装根目录，替换桌面快捷方式

### 2. 配置HTTP Debugger Pro

1. 打开HTTP Debugger Pro
2. 点击顶部菜单栏的`文件` -> `设置`
3. 在`捕获`选项卡中，确保`捕获所有HTTP/HTTPS流量`被勾选
4. 点击`确定`保存设置

## 三、使用步骤

### 1. 启动工具

1. 打开当前文件夹（`Classin视频解析下载工具-非图形化0.3.0`）
2. 找到并运行`classin网址解析.bat`文件

### 2. 捕获视频请求头

1. 打开ClassIn客户端，进入要下载的课程页面
2. 播放视频，确保视频正常加载
3. 切换到HTTP Debugger Pro，点击顶部的`开始捕获`按钮
4. 在HTTP Debugger Pro中，找到包含`getLessonRecordInfo`的请求
5. 右键点击该请求，选择`复制` -> `复制完整请求`

### 3. 解析视频链接

1. 回到命令行窗口，输入`1`并按回车开始解析
2. 工具会自动从剪贴板中解析视频链接和名称
3. 解析成功后，会显示解析结果
4. 可以重复此步骤，解析多个视频
5. 输入`2`并按回车结束解析

### 4. 开始下载

1. 按回车开始下载视频
2. 工具会自动调用`aria2c.exe`进行下载
3. 下载完成后，视频会保存在当前目录的`下载目录`文件夹中

## 四、版本特有功能

### 非图形化0.3.0版本新增功能

1. **升级了aria2c.exe**：使用最新版本的aria2c，提升下载速度和稳定性
2. **优化了解析算法**：增强了对不同格式请求头的支持
3. **修复了特殊字符处理问题**：正确处理课程名称中的特殊字符
4. **改进了用户交互**：更清晰的提示信息
5. **增加了错误处理**：更好地处理解析失败的情况

## 五、常见问题解决

### 1. 解析失败

- 确保已经正确复制了包含`getLessonRecordInfo`的请求头
- 确保HTTP Debugger Pro捕获到了完整的请求
- 尝试重新播放视频并重新捕获请求
- 检查命令行窗口是否以管理员身份运行

### 2. 下载失败

- 检查网络连接是否正常
- 确保`aria2c.exe`文件存在于当前目录
- 检查视频链接是否有效
- 尝试关闭防火墙或杀毒软件后重试

### 3. 工具无法启动

- 确保使用的是Windows系统
- 确保当前目录中有`classin网址解析.bat`文件
- 尝试以管理员身份运行

## 六、注意事项

1. 本工具仅用于个人学习和备份，请勿用于商业用途
2. 请遵守ClassIn平台的使用协议
3. 下载过程中请保持网络连接稳定
4. 建议不要同时下载过多视频，以免影响下载速度
5. 定期清理下载目录，释放磁盘空间
6. 工具会在当前目录生成临时文件`请求头缓存.dll`，使用完成后可手动删除
7. 工具会生成`解析结果.ini`文件，记录解析成功的视频信息
8. 工具会生成`下载视频工具.bat`文件，用于执行下载操作

## 七、技术支持

如有问题或建议，请联系工具开发者。
